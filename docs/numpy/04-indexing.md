# 索引和切片

> 对应代码: [04_indexing.py](file:///d:/Nayey/Code/NayukiChiba/Machine-Learning-Algorithms/Basic/Numpy/04_indexing.py)

## 学习目标

- 掌握 NumPy 数组的基本索引方法
- 学会使用切片操作访问数组元素
- 理解布尔索引和花式索引

## 索引方式对比

| 索引类型 | 语法                   | 说明               |
| -------- | ---------------------- | ------------------ |
| 基本索引 | `arr[0]`, `arr[1,2]`   | 访问单个元素       |
| 切片索引 | `arr[0:5]`, `arr[::2]` | 访问连续或间隔元素 |
| 布尔索引 | `arr[arr > 5]`         | 根据条件筛选元素   |
| 花式索引 | `arr[[0,2,4]]`         | 使用整数数组索引   |

## 基本索引

```python
# 一维数组
arr_1d = np.array([10, 20, 30, 40, 50])
arr_1d[0]     # 10 (第一个元素)
arr_1d[-1]    # 50 (最后一个元素)

# 二维数组
arr_2d = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
arr_2d[0, 0]  # 1 (第一行第一列)
arr_2d[1, 2]  # 6 (第二行第三列)
arr_2d[-1, -1] # 9 (最后一行最后一列)
```

## 切片语法

```
arr[start:stop:step]
```

| 参数    | 说明               | 默认值   |
| ------- | ------------------ | -------- |
| `start` | 起始索引（包含）   | 0        |
| `stop`  | 结束索引（不包含） | 数组长度 |
| `step`  | 步长               | 1        |

### 一维数组切片

```python
arr = np.arange(10)  # [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]

arr[2:7]    # [2, 3, 4, 5, 6]
arr[:5]     # [0, 1, 2, 3, 4]
arr[5:]     # [5, 6, 7, 8, 9]
arr[::2]    # [0, 2, 4, 6, 8]
arr[1::2]   # [1, 3, 5, 7, 9]
arr[::-1]   # [9, 8, 7, 6, 5, 4, 3, 2, 1, 0] (反转)
```

### 二维数组切片

```python
arr = np.arange(20).reshape(4, 5)

arr[:2, :]    # 前 2 行
arr[:, 1:4]   # 第 2-4 列
arr[1:3, 1:3] # 子矩阵
arr[::2, ::2] # 每隔一行每隔一列
```

## 布尔索引

```python
arr = np.arange(1, 11)  # [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

# 单条件筛选
arr[arr > 5]        # [6, 7, 8, 9, 10]
arr[arr % 2 == 0]   # [2, 4, 6, 8, 10]

# 多条件筛选（使用 & 和 |）
arr[(arr >= 3) & (arr <= 7)]  # [3, 4, 5, 6, 7]
arr[(arr < 3) | (arr > 8)]    # [1, 2, 9, 10]

# 取反
arr[~(arr > 5)]     # [1, 2, 3, 4, 5]
```

> [!IMPORTANT]
> 多条件组合时，每个条件必须用括号包围，使用 `&`（与）、`|`（或）、`~`（非）。

## 花式索引

```python
arr = np.arange(10, 20)  # [10, 11, 12, 13, 14, 15, 16, 17, 18, 19]

# 使用整数数组索引
indices = [0, 2, 5, 8]
arr[indices]  # [10, 12, 15, 18]

# 二维数组花式索引
arr_2d = np.arange(12).reshape(3, 4)

# 选择特定行
arr_2d[[0, 2]]  # 第 0 行和第 2 行

# 选择特定元素
rows = [0, 1, 2]
cols = [0, 1, 2]
arr_2d[rows, cols]  # 对角线元素
```

## np.where 条件索引

```python
arr = np.array([1, -2, 3, -4, 5, -6])

# 返回满足条件的索引
np.where(arr > 0)  # (array([0, 2, 4]),)

# 条件替换（三参数形式）
np.where(arr > 0, arr, 0)   # [1, 0, 3, 0, 5, 0]
np.where(arr > 0, 1, -1)    # [1, -1, 1, -1, 1, -1]
```

## 练习

运行代码文件查看完整演示：

```bash
python Basic/Numpy/04_indexing.py
```
